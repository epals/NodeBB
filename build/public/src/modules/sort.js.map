{"version":3,"sources":["public/src/modules/sort.js"],"names":["define","components","api","module","handleSort","field","gotoOnSave","threadSort","get","find","removeClass","currentSetting","config","addClass","$","off","on","refresh","newSetting","params","qs","decodeURIComponent","param","ajaxify","go","this","attr","app","user","uid","payload","settings","put","then","utils","urlParams","sort"],"mappings":"AAAA,aAGAA,OAAO,QAAS,aAAc,OAAQ,SAAUC,EAAYC,GAC3D,IAAIC,KAEJA,EAAOC,WAAa,SAAUC,EAAOC,GACpC,IAAIC,EAAaN,EAAWO,IAAI,eAChCD,EAAWE,KAAK,KAAKC,YAAY,YACjC,IAAIC,EAAiBJ,EAAWE,KAAK,gBAAkBG,OAAOP,GAAS,MACvEM,EAAeF,KAAK,KAAKI,SAAS,YAElCC,EAAE,QACAC,IAAI,QAAS,+BACbC,GAAG,QAAS,8BAA+B,WAC3C,SAASC,EAAQC,EAAYC,GAC5BP,OAAOP,GAASa,EAChB,IAAIE,EAAKC,mBAAmBP,EAAEQ,MAAMH,IACpCI,QAAQC,GAAGlB,GAAcc,EAAK,IAAMA,EAAK,KAE1C,IAAIF,EAAaJ,EAAEW,MAAMC,KAAK,aAC9B,GAAIC,IAAIC,KAAKC,IAAK,CACjB,MAAMC,GAAYC,aAClBD,EAAQC,SAAS1B,GAASa,EAC1BhB,EAAI8B,cAAcL,IAAIC,KAAKC,eAAgBC,GAASG,KAAK,KACxDhB,EAAQC,EAAYgB,MAAMf,gBAErB,CACN,IAAIgB,EAAYD,MAAMf,SACtBgB,EAAUC,KAAOlB,EACjBD,EAAQC,EAAYiB,OAKxB,OAAOhC","file":"public/src/modules/sort.js","sourcesContent":["'use strict';\n\n\ndefine('sort', ['components', 'api'], function (components, api) {\n\tvar module = {};\n\n\tmodule.handleSort = function (field, gotoOnSave) {\n\t\tvar threadSort = components.get('thread/sort');\n\t\tthreadSort.find('i').removeClass('fa-check');\n\t\tvar currentSetting = threadSort.find('a[data-sort=\"' + config[field] + '\"]');\n\t\tcurrentSetting.find('i').addClass('fa-check');\n\n\t\t$('body')\n\t\t\t.off('click', '[component=\"thread/sort\"] a')\n\t\t\t.on('click', '[component=\"thread/sort\"] a', function () {\n\t\t\t\tfunction refresh(newSetting, params) {\n\t\t\t\t\tconfig[field] = newSetting;\n\t\t\t\t\tvar qs = decodeURIComponent($.param(params));\n\t\t\t\t\tajaxify.go(gotoOnSave + (qs ? '?' + qs : ''));\n\t\t\t\t}\n\t\t\t\tvar newSetting = $(this).attr('data-sort');\n\t\t\t\tif (app.user.uid) {\n\t\t\t\t\tconst payload = { settings: {} };\n\t\t\t\t\tpayload.settings[field] = newSetting;\n\t\t\t\t\tapi.put(`/users/${app.user.uid}/settings`, payload).then(() => {\n\t\t\t\t\t\trefresh(newSetting, utils.params());\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tvar urlParams = utils.params();\n\t\t\t\t\turlParams.sort = newSetting;\n\t\t\t\t\trefresh(newSetting, urlParams);\n\t\t\t\t}\n\t\t\t});\n\t};\n\n\treturn module;\n});\n"]}