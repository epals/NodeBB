"use strict";define("composer/categoryList",["categorySelector","taskbar","api"],function(e,t,a){var i={};var o;i.init=function(t,a){var r=t.find(".category-list-container");if(!r.length){return}t.on("action:composer.resize",function(){n(t)});i.updateTaskbar(t,a);o=e.init(r.find('[component="category-selector"]'),{privilege:"topics:create",states:["watching","notwatching","ignoring"],onSelect:function(e){if(a.hasOwnProperty("cid")){c(t,a,e)}}});if(!o){return}if(a.cid&&ajaxify.data.template.category&&parseInt(a.cid,10)===parseInt(ajaxify.data.cid,10)){o.selectedCategory={cid:a.cid,name:ajaxify.data.name}}else if(ajaxify.data.template.compose&&ajaxify.data.selectedCategory){o.selectedCategory={cid:ajaxify.data.cid,name:ajaxify.data.selectedCategory}}t.find(".category-name").translateText(o.selectedCategory?o.selectedCategory.name:"[[modules:composer.select_category]]").on("click",function(){e.modal({privilege:"topics:create",states:["watching","notwatching","ignoring"],openOnLoad:true,showLinks:false,onSelect:function(e){t.find(".category-name").text(e.name);o.selectCategory(e.cid);if(a.hasOwnProperty("cid")){c(t,a,e)}}})});n(t)};function n(e){e.find('.category-list-container [component="category-selector"]').toggleClass("dropup",e.outerHeight()<$(window).height()/2)}i.getSelectedCid=function(){var e;if(o){e=o.getSelectedCategory()}return e?e.cid:0};i.updateTaskbar=function(e,i){if(parseInt(i.cid,10)){var o=e.attr("data-uuid");a.get(`/categories/${i.cid}`,{}).then(function(e){if(e&&e.icon){t.update("composer",o,{image:e.backgroundImage,"background-color":e.bgColor,icon:e.icon.slice(3)})}})}};async function c(e,t,a){t.cid=a.cid;const o=await window.fetch(`${config.relative_path}/api/category/${a.cid}`).then(e=>e.json());require(["composer/scheduler","composer/tags"],function(i,n){i.onChangeCategory(o);n.onChangeCategory(e,t,a.cid,o)});i.updateTaskbar(e,t)}return i});
//# sourceMappingURL=categoryList.js.map