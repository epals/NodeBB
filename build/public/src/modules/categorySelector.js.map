{"version":3,"sources":["public/src/modules/categorySelector.js"],"names":["define","categorySearch","bootbox","categorySelector","init","el","options","length","onSelect","states","template","$","window","trigger","selector","selectedCategory","on","categoryEl","this","hasClass","selectCategory","attr","cid","find","name","html","translateHtml","selectCategoryLabel","getSelectedCategory","getSelectedCid","modal","onSubmit","app","parseAndTranslate","dialog","title","message","buttons","save","label","className","callback","submit","ev","preventDefault","openOnLoad","dropdown"],"mappings":"AAAA,aAEAA,OAAO,oBACN,iBAAkB,WAChB,SAAUC,EAAgBC,GAC5B,IAAIC,KAEJA,EAAiBC,KAAO,SAAUC,EAAIC,GACrC,IAAKD,IAAOA,EAAGE,OAAQ,CACtB,OAEDD,EAAUA,MACV,IAAIE,EAAWF,EAAQE,UAAY,aAEnCF,EAAQG,OAASH,EAAQG,SAAW,WAAY,cAAe,YAC/DH,EAAQI,SAAW,6BACnBC,EAAEC,QAAQC,QAAQ,oCAAsCR,GAAIA,EAAIC,QAASA,IAEzEL,EAAeG,KAAKC,EAAIC,GAExB,IAAIQ,GACHT,GAAIA,EACJU,iBAAkB,MAEnBV,EAAGW,GAAG,QAAS,aAAc,WAC5B,IAAIC,EAAaN,EAAEO,MACnB,GAAID,EAAWE,SAAS,YAAa,CACpC,OAAO,MAERL,EAASM,eAAeH,EAAWI,KAAK,aACxCb,EAASM,EAASC,oBAGnBD,EAASM,eAAiB,SAAUE,GACnC,IAAIL,EAAaH,EAAST,GAAGkB,KAAK,cAAgBD,EAAM,MACxDR,EAASC,kBACRO,IAAKA,EACLE,KAAMP,EAAWI,KAAK,cAGvB,GAAIJ,EAAWV,OAAQ,CACtBO,EAAST,GAAGkB,KAAK,4CAA4CE,KAC5DR,EAAWM,KAAK,iCAAiCE,YAE5C,CACNX,EAAST,GAAGkB,KAAK,4CAA4CG,cAC5DpB,EAAQqB,qBAAuB,4CAIlCb,EAASc,oBAAsB,WAC9B,OAAOd,EAASC,kBAEjBD,EAASe,eAAiB,WACzB,OAAOf,EAASC,iBAAmBD,EAASC,iBAAiBO,IAAM,GAEpE,OAAOR,GAGRX,EAAiB2B,MAAQ,SAAUxB,GAClCA,EAAUA,MACVA,EAAQE,SAAWF,EAAQE,UAAY,aACvCF,EAAQyB,SAAWzB,EAAQyB,UAAY,aACvCC,IAAIC,kBAAkB,+CAAiD,SAAUR,GAChF,IAAIK,EAAQ5B,EAAQgC,QACnBC,MAAO,uCACPC,QAASX,EACTY,SACCC,MACCC,MAAO,oBACPC,UAAW,cACXC,SAAUC,MAKb,IAAI5B,EAAWX,EAAiBC,KAAK0B,EAAMP,KAAK,mCAAoCjB,GACpF,SAASoC,EAAOC,GACfA,EAAGC,iBACH,GAAI9B,EAASC,iBAAkB,CAC9BT,EAAQyB,SAASjB,EAASC,kBAC1Be,EAAMA,MAAM,QAEb,OAAO,MAER,GAAIxB,EAAQuC,WAAY,CACvBf,EAAMd,GAAG,iBAAkB,WAC1Bc,EAAMP,KAAK,oBAAoBuB,SAAS,YAG1ChB,EAAMP,KAAK,QAAQP,GAAG,SAAU0B,MAIlC,OAAOvC","file":"public/src/modules/categorySelector.js","sourcesContent":["'use strict';\n\ndefine('categorySelector', [\n\t'categorySearch', 'bootbox',\n], function (categorySearch, bootbox) {\n\tvar categorySelector = {};\n\n\tcategorySelector.init = function (el, options) {\n\t\tif (!el || !el.length) {\n\t\t\treturn;\n\t\t}\n\t\toptions = options || {};\n\t\tvar onSelect = options.onSelect || function () {};\n\n\t\toptions.states = options.states || ['watching', 'notwatching', 'ignoring'];\n\t\toptions.template = 'partials/category-selector';\n\t\t$(window).trigger('action:category.selector.options', { el: el, options: options });\n\n\t\tcategorySearch.init(el, options);\n\n\t\tvar selector = {\n\t\t\tel: el,\n\t\t\tselectedCategory: null,\n\t\t};\n\t\tel.on('click', '[data-cid]', function () {\n\t\t\tvar categoryEl = $(this);\n\t\t\tif (categoryEl.hasClass('disabled')) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tselector.selectCategory(categoryEl.attr('data-cid'));\n\t\t\tonSelect(selector.selectedCategory);\n\t\t});\n\n\t\tselector.selectCategory = function (cid) {\n\t\t\tvar categoryEl = selector.el.find('[data-cid=\"' + cid + '\"]');\n\t\t\tselector.selectedCategory = {\n\t\t\t\tcid: cid,\n\t\t\t\tname: categoryEl.attr('data-name'),\n\t\t\t};\n\n\t\t\tif (categoryEl.length) {\n\t\t\t\tselector.el.find('[component=\"category-selector-selected\"]').html(\n\t\t\t\t\tcategoryEl.find('[component=\"category-markup\"]').html()\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tselector.el.find('[component=\"category-selector-selected\"]').translateHtml(\n\t\t\t\t\toptions.selectCategoryLabel || '[[topic:thread_tools.select_category]]'\n\t\t\t\t);\n\t\t\t}\n\t\t};\n\t\tselector.getSelectedCategory = function () {\n\t\t\treturn selector.selectedCategory;\n\t\t};\n\t\tselector.getSelectedCid = function () {\n\t\t\treturn selector.selectedCategory ? selector.selectedCategory.cid : 0;\n\t\t};\n\t\treturn selector;\n\t};\n\n\tcategorySelector.modal = function (options) {\n\t\toptions = options || {};\n\t\toptions.onSelect = options.onSelect || function () {};\n\t\toptions.onSubmit = options.onSubmit || function () {};\n\t\tapp.parseAndTranslate('admin/partials/categories/select-category', {}, function (html) {\n\t\t\tvar modal = bootbox.dialog({\n\t\t\t\ttitle: '[[modules:composer.select_category]]',\n\t\t\t\tmessage: html,\n\t\t\t\tbuttons: {\n\t\t\t\t\tsave: {\n\t\t\t\t\t\tlabel: '[[global:select]]',\n\t\t\t\t\t\tclassName: 'btn-primary',\n\t\t\t\t\t\tcallback: submit,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tvar selector = categorySelector.init(modal.find('[component=\"category-selector\"]'), options);\n\t\t\tfunction submit(ev) {\n\t\t\t\tev.preventDefault();\n\t\t\t\tif (selector.selectedCategory) {\n\t\t\t\t\toptions.onSubmit(selector.selectedCategory);\n\t\t\t\t\tmodal.modal('hide');\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (options.openOnLoad) {\n\t\t\t\tmodal.on('shown.bs.modal', function () {\n\t\t\t\t\tmodal.find('.dropdown-toggle').dropdown('toggle');\n\t\t\t\t});\n\t\t\t}\n\t\t\tmodal.find('form').on('submit', submit);\n\t\t});\n\t};\n\n\treturn categorySelector;\n});\n"]}