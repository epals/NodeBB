"use strict";define("categorySearch",function(){var e={};e.init=function(e,t){var n=null;t=t||{};t.privilege=t.privilege||"topics:read";t.states=t.states||["watching","notwatching","ignoring"];var i=[];if(Array.isArray(t.localCategories)){i=t.localCategories.map(e=>({...e}))}t.selectedCids=t.selectedCids||ajaxify.data.selectedCids||[];var o=e.find('[component="category-selector-search"]');if(!o.length){return}var a=o.parent('[component="category/dropdown"]').length>0||o.parent('[component="category-selector"]').length>0;e.on("show.bs.dropdown",function(){if(a){e.find(".dropdown-toggle").addClass("hidden");o.removeClass("hidden")}function i(){var e=o.find("input").val();if(e.length>1||!e&&!n){r(e,function(e){n=n||e;s(e)})}else if(!e&&n){n.forEach(function(e){e.selected=t.selectedCids.includes(e.cid)});s(n)}}o.on("click",function(e){e.preventDefault();e.stopPropagation()});o.find("input").val("").on("keyup",utils.debounce(i,300));i()});e.on("shown.bs.dropdown",function(){o.find("input").focus()});e.on("hide.bs.dropdown",function(){if(a){e.find(".dropdown-toggle").removeClass("hidden");o.addClass("hidden")}o.off("click");o.find("input").off("keyup")});function r(e,n){socket.emit("categories.categorySearch",{search:e,query:utils.params(),parentCid:t.parentCid||0,selectedCids:t.selectedCids,privilege:t.privilege,states:t.states,showLinks:t.showLinks},function(e,t){if(e){return app.alertError(e)}n(i.concat(t))})}function s(n){app.parseAndTranslate(t.template,{categoryItems:n.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},function(t){e.find('[component="category/list"]').replaceWith(t.find('[component="category/list"]'));e.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!n.length)})}};return e});
//# sourceMappingURL=categorySearch.js.map