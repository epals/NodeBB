{"version":3,"sources":["public/src/modules/share.js"],"names":["define","module","addShareHandlers","name","baseUrl","window","location","protocol","host","openShare","url","urlToPost","width","height","open","encodeURIComponent","config","relative_path","$","trigger","off","on","postLink","this","find","val","getPostUrl","setTimeout","putCursorAtEnd","select","addHandler","e","preventDefault","selector","callback","clickedElement","pid","parseInt","parents","attr"],"mappings":"AAAA,aAGAA,OAAO,QAAS,WACf,IAAIC,KAEJA,EAAOC,iBAAmB,SAAUC,GACnC,IAAIC,EAAUC,OAAOC,SAASC,SAAW,KAAOF,OAAOC,SAASE,KAEhE,SAASC,EAAUC,EAAKC,EAAWC,EAAOC,GACzCR,OAAOS,KAAKJ,EAAMK,mBAAmBX,EAAUY,OAAOC,cAAgBN,GAAY,SAAU,SAAWC,EAAQ,WAAaC,EAAS,4BACrIK,EAAEb,QAAQc,QAAQ,qBACjBT,IAAKA,EACLC,UAAWA,IAEZ,OAAO,MAGRO,EAAE,YAAYE,IAAI,oBAAqB,mBAAmBC,GAAG,oBAAqB,kBAAmB,WACpG,IAAIC,EAAWJ,EAAEK,MAAMC,KAAK,cAC5BF,EAASG,IAAIrB,EAAUsB,EAAWR,EAAEK,QAGpCI,WAAW,WACVL,EAASM,iBAAiBC,UACxB,MAGJC,EAAW,aAAc,SAAUC,GAClCA,EAAEC,iBACF,OAAO,QAGRF,EAAW,8BAA+B,WACzC,OAAOrB,EAAU,yCAA2CM,mBAAmBZ,GAAQ,QAASuB,EAAWR,EAAEK,OAAQ,IAAK,OAG3HO,EAAW,+BAAgC,WAC1C,OAAOrB,EAAU,gDAAiDiB,EAAWR,EAAEK,OAAQ,IAAK,OAG7FO,EAAW,6BAA8B,WACxC,OAAOrB,EAAU,qCAAsCiB,EAAWR,EAAEK,OAAQ,IAAK,OAGlFL,EAAEb,QAAQc,QAAQ,4BAA8BV,UAAWA,KAG5D,SAASqB,EAAWG,EAAUC,GAC7BhB,EAAE,YAAYE,IAAI,QAASa,GAAUZ,GAAG,QAASY,EAAUC,GAG5D,SAASR,EAAWS,GACnB,IAAIC,EAAMC,SAASF,EAAeG,QAAQ,cAAcC,KAAK,YAAa,IAC1E,MAAO,SAAWH,EAAM,IAAM,EAAQ,IAGvC,OAAOnC","file":"public/src/modules/share.js","sourcesContent":["'use strict';\n\n\ndefine('share', function () {\n\tvar module = {};\n\n\tmodule.addShareHandlers = function (name) {\n\t\tvar baseUrl = window.location.protocol + '//' + window.location.host;\n\n\t\tfunction openShare(url, urlToPost, width, height) {\n\t\t\twindow.open(url + encodeURIComponent(baseUrl + config.relative_path + urlToPost), '_blank', 'width=' + width + ',height=' + height + ',scrollbars=no,status=no');\n\t\t\t$(window).trigger('action:share.open', {\n\t\t\t\turl: url,\n\t\t\t\turlToPost: urlToPost,\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\t$('#content').off('shown.bs.dropdown', '.share-dropdown').on('shown.bs.dropdown', '.share-dropdown', function () {\n\t\t\tvar postLink = $(this).find('.post-link');\n\t\t\tpostLink.val(baseUrl + getPostUrl($(this)));\n\n\t\t\t// without the setTimeout can't select the text in the input\n\t\t\tsetTimeout(function () {\n\t\t\t\tpostLink.putCursorAtEnd().select();\n\t\t\t}, 50);\n\t\t});\n\n\t\taddHandler('.post-link', function (e) {\n\t\t\te.preventDefault();\n\t\t\treturn false;\n\t\t});\n\n\t\taddHandler('[component=\"share/twitter\"]', function () {\n\t\t\treturn openShare('https://twitter.com/intent/tweet?text=' + encodeURIComponent(name) + '&url=', getPostUrl($(this)), 550, 420);\n\t\t});\n\n\t\taddHandler('[component=\"share/facebook\"]', function () {\n\t\t\treturn openShare('https://www.facebook.com/sharer/sharer.php?u=', getPostUrl($(this)), 626, 436);\n\t\t});\n\n\t\taddHandler('[component=\"share/google\"]', function () {\n\t\t\treturn openShare('https://plus.google.com/share?url=', getPostUrl($(this)), 500, 570);\n\t\t});\n\n\t\t$(window).trigger('action:share.addHandlers', { openShare: openShare });\n\t};\n\n\tfunction addHandler(selector, callback) {\n\t\t$('#content').off('click', selector).on('click', selector, callback);\n\t}\n\n\tfunction getPostUrl(clickedElement) {\n\t\tvar pid = parseInt(clickedElement.parents('[data-pid]').attr('data-pid'), 10);\n\t\treturn '/post' + (pid ? '/' + (pid) : '');\n\t}\n\n\treturn module;\n});\n"]}