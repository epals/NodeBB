"use strict";define("forum/categories",["components","categorySelector","hooks"],function(e,t,o){var n={};$(window).on("action:ajaxify.start",function(e,t){if(ajaxify.currentPage!==t.url){socket.removeListener("event:new_post",n.onNewPost)}});n.init=function(){app.enterRoom("categories");socket.removeListener("event:new_post",n.onNewPost);socket.on("event:new_post",n.onNewPost);t.init($('[component="category-selector"]'),{privilege:"find",onSelect:function(e){ajaxify.go("/category/"+e.cid)}});$(".category-header").tooltip({placement:"bottom"})};n.onNewPost=function(e){if(e&&e.posts&&e.posts.length&&e.posts[0].topic){s(e.posts[0].topic.cid,e.posts[0])}};function s(t,n){var s=e.get("categories/category","cid",t);var i=s.attr("data-numRecentReplies");if(!i||!parseInt(i,10)){return}if(!s.find('[component="topic/teaser"]').length){return}var r=s.find('[component="category/posts"]');app.parseAndTranslate("partials/categories/lastpost","posts",{posts:[n]},function(e){e.find(".post-content img:not(.not-responsive)").addClass("img-responsive");e.hide();if(r.length===0){e.appendTo(s)}else{e.insertBefore(r.first())}e.fadeIn();app.createUserTooltips();e.find(".timeago").timeago();if(s.find('[component="category/posts"]').length>parseInt(i,10)){r.last().remove()}o.fire("action:posts.loaded",{posts:[n]})})}return n});
//# sourceMappingURL=categories.js.map