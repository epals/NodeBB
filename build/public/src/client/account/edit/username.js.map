{"version":3,"sources":["public/src/client/account/edit/username.js"],"names":["define","header","api","slugify","AccountEditUsername","init","$","on","updateUsername","userData","uid","val","username","password","app","alertError","btn","this","addClass","find","removeClass","put","then","response","userslug","parseInt","user","attr","config","relative_path","text","css","ajaxify","go","catch","finally"],"mappings":"AAAA,aAEAA,OAAO,+BACN,uBAAwB,MAAO,WAC7B,SAAUC,EAAQC,EAAKC,GACzB,IAAIC,KAEJA,EAAoBC,KAAO,WAC1BJ,EAAOI,OAEPC,EAAE,cAAcC,GAAG,QAAS,SAASC,IACpC,IAAIC,GACHC,IAAKJ,EAAE,aAAaK,MACpBC,SAAUN,EAAE,qBAAqBK,MACjCE,SAAUP,EAAE,yBAAyBK,OAGtC,IAAKF,EAASG,SAAU,CACvB,OAGD,GAAIH,EAASG,WAAaH,EAASI,SAAU,CAC5C,OAAOC,IAAIC,WAAW,sCAGvB,IAAIC,EAAMV,EAAEW,MACZD,EAAIE,SAAS,YAAYC,KAAK,KAAKC,YAAY,QAE/ClB,EAAImB,IAAI,UAAYZ,EAASC,IAAKD,GAAUa,KAAMC,IACjD,IAAIC,EAAWrB,EAAQM,EAASG,UAChC,GAAIH,EAASG,UAAYY,GAAYC,SAAShB,EAASC,IAAK,MAAQe,SAASX,IAAIY,KAAKhB,IAAK,IAAK,CAC/FJ,EAAE,oCAAoCqB,KAAK,OAAQC,OAAOC,cAAgB,SAAWL,GACrFlB,EAAE,yCAAyCqB,KAAK,OAAQC,OAAOC,cAAgB,SAAWL,EAAW,SACrGlB,EAAE,6CAA6CqB,KAAK,OAAQC,OAAOC,cAAgB,SAAWL,EAAW,aACzGlB,EAAE,iCAAiCwB,KAAKrB,EAASG,UACjDN,EAAE,iCAAiCyB,IAAI,mBAAoBR,EAAS,iBAAiBO,KAAKP,EAAS,cACnGjB,EAAE,6BAA6ByB,IAAI,mBAAoBR,EAAS,iBAAiBO,KAAKP,EAAS,cAGhGS,QAAQC,GAAG,QAAUT,EAAW,WAC9BU,MAAMpB,IAAIC,YACXoB,QAAQ,KACRnB,EAAII,YAAY,YAAYD,KAAK,KAAKD,SAAS,UAGjD,OAAO,SAIT,OAAOd","file":"public/src/client/account/edit/username.js","sourcesContent":["'use strict';\n\ndefine('forum/account/edit/username', [\n\t'forum/account/header', 'api', 'slugify',\n], function (header, api, slugify) {\n\tvar AccountEditUsername = {};\n\n\tAccountEditUsername.init = function () {\n\t\theader.init();\n\n\t\t$('#submitBtn').on('click', function updateUsername() {\n\t\t\tvar userData = {\n\t\t\t\tuid: $('#inputUID').val(),\n\t\t\t\tusername: $('#inputNewUsername').val(),\n\t\t\t\tpassword: $('#inputCurrentPassword').val(),\n\t\t\t};\n\n\t\t\tif (!userData.username) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (userData.username === userData.password) {\n\t\t\t\treturn app.alertError('[[user:username_same_as_password]]');\n\t\t\t}\n\n\t\t\tvar btn = $(this);\n\t\t\tbtn.addClass('disabled').find('i').removeClass('hide');\n\n\t\t\tapi.put('/users/' + userData.uid, userData).then((response) => {\n\t\t\t\tvar userslug = slugify(userData.username);\n\t\t\t\tif (userData.username && userslug && parseInt(userData.uid, 10) === parseInt(app.user.uid, 10)) {\n\t\t\t\t\t$('[component=\"header/profilelink\"]').attr('href', config.relative_path + '/user/' + userslug);\n\t\t\t\t\t$('[component=\"header/profilelink/edit\"]').attr('href', config.relative_path + '/user/' + userslug + '/edit');\n\t\t\t\t\t$('[component=\"header/profilelink/settings\"]').attr('href', config.relative_path + '/user/' + userslug + '/settings');\n\t\t\t\t\t$('[component=\"header/username\"]').text(userData.username);\n\t\t\t\t\t$('[component=\"header/usericon\"]').css('background-color', response['icon:bgColor']).text(response['icon:text']);\n\t\t\t\t\t$('[component=\"avatar/icon\"]').css('background-color', response['icon:bgColor']).text(response['icon:text']);\n\t\t\t\t}\n\n\t\t\t\tajaxify.go('user/' + userslug + '/edit');\n\t\t\t}).catch(app.alertError)\n\t\t\t\t.finally(() => {\n\t\t\t\t\tbtn.removeClass('disabled').find('i').addClass('hide');\n\t\t\t\t});\n\n\t\t\treturn false;\n\t\t});\n\t};\n\n\treturn AccountEditUsername;\n});\n"]}