{"version":3,"sources":["public/src/client/account/sessions.js"],"names":["define","header","components","api","Sessions","init","prepareSessionRevocation","get","on","parentEl","$","this","parents","uuid","attr","del","ajaxify","data","uid","then","remove","catch","err","errorObj","JSON","parse","responseText","loggedIn","window","location","href","config","relative_path","title","app","alertError","e"],"mappings":"AAAA,aAGAA,OAAO,0BAA2B,uBAAwB,aAAc,OAAQ,SAAUC,EAAQC,EAAYC,GAC7G,IAAIC,KAEJA,EAASC,KAAO,WACfJ,EAAOI,OACPD,EAASE,4BAGVF,EAASE,yBAA2B,WACnCJ,EAAWK,IAAI,iBAAiBC,GAAG,QAAS,gBAAiB,WAC5D,IAAIC,EAAWC,EAAEC,MAAMC,QAAQ,eAC/B,IAAIC,EAAOJ,EAASK,KAAK,aAEzB,GAAID,EAAM,CAGTV,EAAIY,cAAcC,QAAQC,KAAKC,gBAAgBL,QAAYM,KAAK,KAC/DV,EAASW,WACPC,MAAOC,IACT,IACC,IAAIC,EAAWC,KAAKC,MAAMH,EAAII,cAC9B,GAAIH,EAASI,WAAa,MAAO,CAChCC,OAAOC,SAASC,KAAOC,OAAOC,cAAgB,gBAAkBT,EAASU,MAE1EC,IAAIC,WAAWZ,EAASU,OACvB,MAAOG,GACRF,IAAIC,WAAW,iCAOpB,OAAO/B","file":"public/src/client/account/sessions.js","sourcesContent":["'use strict';\n\n\ndefine('forum/account/sessions', ['forum/account/header', 'components', 'api'], function (header, components, api) {\n\tvar Sessions = {};\n\n\tSessions.init = function () {\n\t\theader.init();\n\t\tSessions.prepareSessionRevocation();\n\t};\n\n\tSessions.prepareSessionRevocation = function () {\n\t\tcomponents.get('user/sessions').on('click', '[data-action]', function () {\n\t\t\tvar parentEl = $(this).parents('[data-uuid]');\n\t\t\tvar uuid = parentEl.attr('data-uuid');\n\n\t\t\tif (uuid) {\n\t\t\t\t// This is done via DELETE because a user shouldn't be able to\n\t\t\t\t// revoke his own session! This is what logout is for\n\t\t\t\tapi.del(`/users/${ajaxify.data.uid}/sessions/${uuid}`, {}).then(() => {\n\t\t\t\t\tparentEl.remove();\n\t\t\t\t}).catch((err) => {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar errorObj = JSON.parse(err.responseText);\n\t\t\t\t\t\tif (errorObj.loggedIn === false) {\n\t\t\t\t\t\t\twindow.location.href = config.relative_path + '/login?error=' + errorObj.title;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tapp.alertError(errorObj.title);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tapp.alertError('[[error:invalid-data]]');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t};\n\n\treturn Sessions;\n});\n"]}